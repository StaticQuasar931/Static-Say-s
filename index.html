<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Static Says - by StaticQuasar931</title>
  <!-- SEO & Indexing -->
  <meta name="description" content="Play Static Says – the fast-paced memory reaction game by StaticQuasar931. Inspired by Simon Says but with shapes, colors, and speed! Try to beat your high score.">
  <meta name="keywords" content="Static Says, simon says unblocked, memory game, reaction game, shape clicker, staticquasar931 games, static says online">

  <style>
    /********************************************************
      BASIC RESET & BODY
    *********************************************************/
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: Arial, sans-serif;
    }
    html, body {
      width: 100%; 
      height: 100%; 
      overflow: hidden;
      background: #202020; 
      color: #fff;
    }
    body {
      display: flex; 
      flex-direction: column; 
      align-items: center;
      justify-content: center;
      position: relative;
    }
    a { color: #0af; text-decoration: none; }

    /********************************************************
      STATIC MENU (top-left)
    *********************************************************/
    #staticMenu {
      position: fixed; 
      top: 10px; 
      left: 10px;
      background: #222; 
      color: #fff;
      padding: 10px 15px; 
      border-radius: 8px;
      z-index: 9999;
      box-shadow: 0 0 8px rgba(0,0,0,0.6);
      animation: twinkle 2s infinite;
    }
    @keyframes twinkle {
      0%, 100% { box-shadow: 0 0 8px rgba(0,255,255,0.7); }
      50% { box-shadow: 0 0 4px rgba(0,255,255,0.2); }
    }
    #closeMenu {
      background: #444; 
      color: #fff; 
      border: none; 
      cursor: pointer;
      padding: 4px 8px; 
      margin-left: 10px;
      border-radius: 4px;
    }
    #closeMenu:hover {
      background: #666;
    }

    /********************************************************
      SETTINGS BUTTON (top-right)
    *********************************************************/
    #settingsButton {
      position: fixed; 
      top: 10px; 
      right: 10px;
      background: #444; 
      color: #fff;
      border: 1px solid #666;
      padding: 12px 20px;  /* Bigger button */
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      z-index: 9999;
      transition: transform 0.2s, background 0.2s;
    }
    #settingsButton:hover { 
      transform: scale(1.05);
      background: #333; 
    }

    /********************************************************
      SETTINGS OVERLAY (3x bigger)
    *********************************************************/
    #settingsOverlay {
      position: fixed; 
      top: 0; 
      left: 0;
      width: 100%; 
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      align-items: center; 
      justify-content: center;
      z-index: 9999;
    }
    #settingsBox {
      background: #333; 
      padding: 60px 90px; /* triple original */
      border-radius: 12px;
      width: 600px; 
      text-align: center;
      color: #fff;
    }
    #settingsBox h3 {
      font-size: 2rem;
      margin-bottom: 20px;
    }
    .settingsRow { 
      margin: 30px 0; /* bigger spacing */
      font-size: 1.3rem; 
    }
    #closeSettingsBtn, #shareButton {
      background: #555; 
      color: #fff; 
      border: none;
      padding: 12px 20px;
      font-size: 1.2rem;
      border-radius: 6px;
      cursor: pointer;
      margin: 10px;
      transition: background 0.2s, transform 0.2s;
    }
    #closeSettingsBtn:hover, #shareButton:hover {
      background: #777;
      transform: scale(1.05);
    }

    /********************************************************
      QR CODE (bottom-left) - bigger
    *********************************************************/
    #qrContainer {
      position: fixed; 
      bottom: 10px; 
      left: 10px;
      z-index: 9998;
    }
    #qrContainer img {
      width: 140px; 
      height: 140px;
      border: 2px solid #fff;
      border-radius: 8px;
      transition: transform 0.2s;
    }
    #qrContainer img:hover {
      transform: scale(1.05);
    }

    /********************************************************
      GLOBAL STATS (bottom-right) - bigger
    *********************************************************/
    #statsContainer {
      position: fixed; 
      bottom: 10px; 
      right: 10px;
      background: rgba(0,0,0,0.6); 
      color: #fff;
      padding: 16px 22px; 
      border-radius: 8px;
      font-size: 1.2rem; 
      line-height: 1.8em;
      z-index: 9998;
      transition: transform 0.2s;
    }
    #statsContainer:hover {
      transform: scale(1.02);
    }
    #statsContainer strong {
      font-size: 1.2rem;
    }

    /********************************************************
      MAIN MENU
    *********************************************************/
    #mainMenu {
      width: 100%; 
      height: 100%; 
      display: flex; 
      flex-direction: column;
      align-items: center; 
      justify-content: center;
    }
    #gameTitle {
      font-size: 4rem; 
      margin-bottom: 30px; 
      text-align: center;
      font-weight: bold;
    }
    #mapSelectContainer {
      display: flex; 
      gap: 40px; 
      margin: 30px 0;
    }
    .mapChoice {
      width: 220px; 
      height: 130px;
      background: #333; 
      color: #fff;
      display: flex; 
      justify-content: center; 
      align-items: center;
      cursor: pointer; 
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(255,255,255,0.1);
      transition: transform 0.2s, background 0.2s;
      text-align: center;
      font-size: 1.4rem;
    }
    .mapChoice:hover {
      transform: scale(1.08);
      background: #444;
    }
    .mapDisabled {
      background: #555 !important;
      cursor: not-allowed;
      opacity: 0.5;
    }

    /********************************************************
      DIFFICULTY MENU
    *********************************************************/
    #difficultyMenu {
      display: none;
      width: 100%; 
      height: 100%;
      flex-direction: column; 
      align-items: center; 
      justify-content: center;
      position: relative;
    }
    #difficultyTitle {
      font-size: 3rem; 
      margin-bottom: 20px;
      text-align: center;
    }
    #difficultyNote {
      margin-bottom: 30px; 
      text-align: center;
      font-size: 1.3rem;
      line-height: 1.4em;
    }
    #difficultySelectContainer {
      display: flex; 
      flex-direction: column; 
      gap: 30px;
      text-align: center;
    }
    .difficultyChoice {
      width: 300px; 
      padding: 16px 0;
      margin: 0 auto;
      border-radius: 8px; 
      color: #fff;
      font-weight: bold; 
      cursor: pointer; 
      font-size: 1.6rem;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .difficultyChoice:hover {
      transform: scale(1.08);
      box-shadow: 0 0 12px rgba(255,255,255,0.2);
    }
    #easyBtn { background: green; }
    #mediumBtn { background: orange; }
    /* Hardcore shakes while hovered *continuously* */
    #hardcoreBtn {
      background: red;
    }
    #hardcoreBtn:hover {
      animation: hardcoreShake 0.3s infinite;
    }
    @keyframes hardcoreShake {
      0% { transform: translate(1px, 1px) rotate(0deg); }
      20% { transform: translate(-2px, -1px) rotate(-2deg); }
      40% { transform: translate(2px, 0px) rotate(1deg); }
      60% { transform: translate(-2px, 2px) rotate(2deg); }
      80% { transform: translate(1px, -2px) rotate(-1deg); }
      100% { transform: translate(1px, 1px) rotate(0deg); }
    }

    /********************************************************
      RULES/EXPLANATION OVERLAY
    *********************************************************/
    #rulesOverlay {
      display: none;
      position: fixed; 
      top: 0; 
      left: 0;
      width: 100%; 
      height: 100%;
      background: rgba(0,0,0,0.7);
      justify-content: center; 
      align-items: center;
      z-index: 2000;
    }
    #rulesBox {
      background: #222; 
      padding: 20px 30px;
      border-radius: 10px; 
      max-width: 600px; 
      text-align: center;
    }
    #rulesBox h2 { margin-bottom: 10px; }
    #rulesBox p {
      margin: 10px 0; 
      line-height: 1.4em; 
      font-size: 1rem;
    }
    #startGameBtn {
      margin-top: 15px; 
      padding: 12px 24px;
      font-size: 1.2rem; 
      border: none; 
      border-radius: 8px;
      cursor: pointer; 
      color: #fff;
      background: #555;
      transition: background 0.2s, transform 0.2s;
    }
    #startGameBtn:hover {
      transform: scale(1.05);
      background: #777;
    }

    /********************************************************
      GAME AREA (CHEERFUL BACKGROUND)
    *********************************************************/
    #gameArea {
      display: none; /* Show when game starts */
      position: relative;
      width: 100%; 
      height: 100%;
      /* more cheerful gradient */
      background: radial-gradient(circle, #559955, #77bb77);
      overflow: hidden;
    }

    /* FLASH RED ON LIFE LOSS */
    .lifeLossFlash {
      animation: lifeLossAnim 0.5s;
    }
    @keyframes lifeLossAnim {
      0% { background-color: rgba(255,0,0,0.7); }
      50% { background-color: rgba(255,0,0,0); }
      100% { background-color: rgba(255,0,0,0); }
    }

    /* MAP 1 container */
    #map1Container {
      position: absolute; 
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0;
    }

    /* Example shapes in grayscale – text references color */
    .map1Shape {
      position: absolute;
      display: flex; 
      align-items: center; 
      justify-content: center;
      font-weight: bold; 
      font-size: 1rem;
      cursor: pointer; 
      user-select: none;
      background: #aaa;       /* Grayscale */
      border: 2px solid #666;
      color: #000;
      text-align: center;
      transition: transform 0.2s;
    }
    .map1Shape:hover {
      transform: scale(1.1);
    }

    /* Distinct shapes/sizes */
    .square  { width: 60px;  height: 60px;  border-radius: 4px; }
    .circle  { width: 60px;  height: 60px;  border-radius: 50%; }
    .bigCircle { width: 80px; height: 80px; border-radius: 50%; }
    .smallCircle { width: 40px; height: 40px; border-radius: 50%; }

    /* Example positions for shapes */
    #shape1  { top:  50px; left:  50px; }
    #shape2  { top:  50px; right: 70px; }
    #shape3  { bottom: 70px; left: 50px; }
    #shape4  { bottom: 70px; right: 70px; }
    #shape5  { top:  200px; left: 30%; }
    #shape6  { top:  200px; left: 60%; }
    #shape7  { top:  300px; left: 20%; }
    #shape8  { top:  300px; left: 50%; }
    #shape9  { top:  300px; left: 80%; }
    #shape10 { bottom: 150px; left: 25%; }
    #shape11 { bottom: 150px; left: 50%; }
    #shape12 { bottom: 150px; left: 75%; }
    #shape13 { top: 120px; left: 40%; }
    #shape14 { top: 120px; left: 55%; }
    #shape15 { top: 400px; left: 60%; }

    /********************************************************
      IN-GAME HUD
    *********************************************************/
    /* We'll show a big timer to the left, question text to the right */
    #inGameHUD {
      position: absolute; 
      top: 30px; 
      width: 100%;
      display: flex; 
      flex-direction: row;
      align-items: flex-start;
      justify-content: center;
      pointer-events: none; /* doesn't block shape clicks */
      gap: 20px;
    }
    #timeLeft {
      font-size: 2rem; 
      font-weight: bold;
      background: rgba(0,0,0,0.5);
      padding: 10px 15px; 
      border-radius: 8px;
      pointer-events: none;
      min-width: 120px;
      text-align: center;
    }
    #commandText {
      font-size: 1.5rem;
      line-height: 1.4em;
      background: rgba(0,0,0,0.5);
      padding: 10px 15px; 
      border-radius: 8px;
      pointer-events: none;
      max-width: 600px;
    }

    /* Middle-left stats panel during match */
    #scoreHUD {
      position: absolute; 
      top: 200px; 
      left: 10px;
      background: rgba(0,0,0,0.5); 
      border-radius: 8px;
      padding: 12px 20px;
      font-size: 1.2rem;
      pointer-events: none;
      line-height: 1.6em;
    }
    .label {
      font-weight: bold;
    }

    /********************************************************
      GAME OVER
    *********************************************************/
    #gameOverOverlay {
      display: none; 
      position: fixed; 
      top: 0; 
      left: 0;
      width: 100%; 
      height: 100%;
      background: rgba(0,0,0,0.8);
      justify-content: center; 
      align-items: center;
      z-index: 3000;
      text-align: center;
    }
    #gameOverBox {
      background: #222; 
      padding: 30px; 
      border-radius: 10px; 
      width: 350px;
    }
    #gameOverBox h2 { margin-bottom: 15px; }
    #gameOverBox button {
      background: #444; 
      color: #fff; 
      border: none;
      padding: 12px 20px; 
      cursor: pointer; 
      border-radius: 8px;
      margin: 10px;
      font-size: 1rem;
      transition: transform 0.2s, background 0.2s;
    }
    #gameOverBox button:hover {
      background: #666;
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <!-- SOUND EFFECTS -->
  <audio id="sndLoseLife" preload="auto">
    <source src="data:audio/mpeg;base64,//uQx..." type="audio/mpeg">
  </audio>
  <audio id="sndHardcoreSelect" preload="auto">
    <source src="data:audio/mpeg;base64,//uQx..." type="audio/mpeg">
  </audio>
  <audio id="sndHighScore" preload="auto">
    <source src="data:audio/mpeg;base64,//uQx..." type="audio/mpeg">
  </audio>

  <!-- STATIC MENU (top-left) -->
  <div id="staticMenu">
    <a href="https://sites.google.com/view/staticquasar931" target="_blank">Main Static Site</a>
    <button id="closeMenu">✖</button>
  </div>

  <!-- SETTINGS BUTTON (top-right) -->
  <button id="settingsButton">Settings</button>

  <!-- SETTINGS OVERLAY (3x bigger) -->
  <div id="settingsOverlay">
    <div id="settingsBox">
      <h3>Settings</h3>
      <div class="settingsRow">
        <label>
          <input type="checkbox" id="colorBlindToggle"> 
          Color-Blind Mode
        </label>
      </div>
      <div class="settingsRow">
        <p style="font-size:1.2rem;">
          <strong>Color Remapping Example:</strong><br/>
          <em>Red</em> ⇒ <em>cbm red</em><br/>
          <em>Green</em> ⇒ <em>cbm green</em><br/>
          <em>Blue</em> ⇒ <em>cbm blue</em> ... etc
        </p>
      </div>
      <div class="settingsRow">
        <label for="soundSlider">Sound Volume</label><br/>
        <input type="range" id="soundSlider" min="0" max="100" value="50" />
      </div>
      <div class="settingsRow">
        <button id="shareButton">Share This Game</button>
      </div>
      <div class="settingsRow">
        <button id="closeSettingsBtn">Close</button>
      </div>
    </div>
  </div>

  <!-- QR CODE (bottom-left) -->
  <div id="qrContainer">
    <a href="https://sites.google.com/view/staticquasar931" target="_blank">
      <img 
        src="https://res.cloudinary.com/dcsrqennd/image/upload/v1733694622/frame_1_vmv9y3.png" 
        alt="QR Code to Static's Website" 
      />
    </a>
  </div>

  <!-- GLOBAL STATS (bottom-right) -->
  <div id="statsContainer">
    <strong>Global Stats</strong><br/>
    Total Rounds Played: <span id="totalRoundsSpan">0</span><br/><br/>
    <strong>Easy</strong> – Rounds: <span id="easyRoundsSpan">0</span>, High: <span id="easyHighSpan">0</span><br/>
    <strong>Medium</strong> – Rounds: <span id="mediumRoundsSpan">0</span>, High: <span id="mediumHighSpan">0</span><br/>
    <strong>Hardcore</strong> – Rounds: <span id="hardcoreRoundsSpan">0</span>, High: <span id="hardcoreHighSpan">0</span>
  </div>

  <!-- MAIN MENU -->
  <div id="mainMenu">
    <div id="gameTitle">🌀 Static Says</div>
    <div id="mapSelectContainer">
      <!-- Map 1 (Enabled) -->
      <div class="mapChoice" id="map1Btn">
        <span>Map 1</span>
      </div>
      <!-- Map 2 (Coming Soon) -->
      <div class="mapChoice mapDisabled" id="map2Btn">
        <span>Map 2 (Coming Soon)</span>
      </div>
      <!-- Map 3 (Coming Soon) -->
      <div class="mapChoice mapDisabled" id="map3Btn">
        <span>Map 3 (Coming Soon)</span>
      </div>
    </div>
  </div>

  <!-- DIFFICULTY MENU -->
  <div id="difficultyMenu">
    <div id="difficultyTitle">Choose Difficulty</div>
    <div id="difficultyNote">
      <strong>Easy:</strong> 4 lives, slower speed<br/>
      <strong>Medium:</strong> 2 lives, moderate speed<br/>
      <strong>Hardcore:</strong> 1 life, fastest speed
    </div>
    <div id="difficultySelectContainer">
      <div class="difficultyChoice" id="easyBtn">EASY</div>
      <div class="difficultyChoice" id="mediumBtn">MEDIUM</div>
      <div class="difficultyChoice" id="hardcoreBtn">HARDCORE</div>
    </div>
  </div>

  <!-- RULES OVERLAY -->
  <div id="rulesOverlay">
    <div id="rulesBox">
      <h2>How to Play "Static Says"</h2>
      <p>
        1) If the command starts with <strong>“Static says...”</strong>, <em>perform</em> it.<br/>
        2) If it does NOT, <em>do nothing</em>.<br/>
        3) Each correct action = +1 point. Lose a life if you do it wrong.<br/>
        4) Speed and lives depend on difficulty and rounds in.
      </p>
      <p id="difficultyInfoText"></p>
      <button id="startGameBtn">Start Game</button>
    </div>
  </div>

  <!-- GAME AREA -->
  <div id="gameArea">
    <!-- MAP 1 -->
    <div id="map1Container">
      <!-- 15 sample shapes: squares/circles, different sizes, some with numbers -->
      <!-- We keep them grayscale; color is just referenced in text -->
      <div class="map1Shape square"   id="shape1">1</div>
      <div class="map1Shape circle"   id="shape2">2</div>
      <div class="map1Shape square"   id="shape3"></div>
      <div class="map1Shape circle"   id="shape4">4</div>
      <div class="map1Shape square"   id="shape5">5</div>
      <div class="map1Shape circle"   id="shape6"></div>
      <div class="map1Shape square"   id="shape7">7</div>
      <div class="map1Shape square"   id="shape8">8</div>
      <div class="map1Shape square"   id="shape9"></div>
      <div class="map1Shape bigCircle"   id="shape10">10</div>
      <div class="map1Shape square"   id="shape11"></div>
      <div class="map1Shape smallCircle" id="shape12">12</div>
      <div class="map1Shape smallCircle" id="shape13"></div>
      <div class="map1Shape bigCircle"   id="shape14"></div>
      <div class="map1Shape circle"      id="shape15">15</div>
    </div>

    <!-- HUD -->
    <div id="inGameHUD">
      <div id="timeLeft">0s</div>
      <div id="commandText"></div>
    </div>
    <!-- Middle-left stats in-game -->
    <div id="scoreHUD">
      <div><span class="label">Difficulty:</span> <span id="currentDifficulty">-</span></div>
      <div><span class="label">Lives:</span> <span id="livesCount">0</span></div>
      <div><span class="label">Score:</span> <span id="roundScore">0</span></div>
      <div><span class="label">High:</span> <span id="currHighScore">0</span></div>
    </div>
  </div>

  <!-- GAME OVER OVERLAY -->
  <div id="gameOverOverlay">
    <div id="gameOverBox">
      <h2>Game Over</h2>
      <p id="gameOverMsg"></p>
      <button id="menuReturnBtn">Return to Main Menu</button>
    </div>
  </div>

  <script>
  /********************************************************
    LOCAL STORAGE SETUP
  *********************************************************/
  let defaultStats = {
    totalRounds: 0,
    easy: { roundsPlayed: 0, highScore: 0 },
    medium: { roundsPlayed: 0, highScore: 0 },
    hardcore: { roundsPlayed: 0, highScore: 0 }
  };
  let gameStats = JSON.parse(localStorage.getItem('staticSaysStats')) || defaultStats;

  function saveStatsToLocal() {
    localStorage.setItem('staticSaysStats', JSON.stringify(gameStats));
  }

  /********************************************************
    UPDATE STATS UI (BOTTOM-RIGHT)
  *********************************************************/
  function updateStatsUI() {
    document.getElementById('totalRoundsSpan').textContent = gameStats.totalRounds;
    document.getElementById('easyRoundsSpan').textContent = gameStats.easy.roundsPlayed;
    document.getElementById('easyHighSpan').textContent = gameStats.easy.highScore;
    document.getElementById('mediumRoundsSpan').textContent = gameStats.medium.roundsPlayed;
    document.getElementById('mediumHighSpan').textContent = gameStats.medium.highScore;
    document.getElementById('hardcoreRoundsSpan').textContent = gameStats.hardcore.roundsPlayed;
    document.getElementById('hardcoreHighSpan').textContent = gameStats.hardcore.highScore;
  }
  updateStatsUI();

  /********************************************************
    GLOBAL DOM ELEMENTS
  *********************************************************/
  // Main UI
  const mainMenu            = document.getElementById('mainMenu');
  const map1Btn             = document.getElementById('map1Btn');
  const map2Btn             = document.getElementById('map2Btn');
  const map3Btn             = document.getElementById('map3Btn');
  // Difficulty UI
  const difficultyMenu      = document.getElementById('difficultyMenu');
  const easyBtn             = document.getElementById('easyBtn');
  const mediumBtn           = document.getElementById('mediumBtn');
  const hardcoreBtn         = document.getElementById('hardcoreBtn');
  // Rules overlay
  const rulesOverlay        = document.getElementById('rulesOverlay');
  const startGameBtn        = document.getElementById('startGameBtn');
  const difficultyInfoText  = document.getElementById('difficultyInfoText');
  // Game area
  const gameArea            = document.getElementById('gameArea');
  const inGameHUD           = document.getElementById('inGameHUD');
  const commandText         = document.getElementById('commandText');
  const timeLeftEl          = document.getElementById('timeLeft');
  const livesCountEl        = document.getElementById('livesCount');
  const roundScoreEl        = document.getElementById('roundScore');
  const currHighScoreEl     = document.getElementById('currHighScore');
  const currentDifficultyEl = document.getElementById('currentDifficulty');
  const scoreHUD            = document.getElementById('scoreHUD');
  // Game over
  const gameOverOverlay     = document.getElementById('gameOverOverlay');
  const gameOverMsg         = document.getElementById('gameOverMsg');
  const menuReturnBtn       = document.getElementById('menuReturnBtn');
  // Stats & QR containers
  const qrContainer         = document.getElementById('qrContainer');
  const statsContainer      = document.getElementById('statsContainer');
  // Settings
  const settingsButton      = document.getElementById('settingsButton');
  const settingsOverlay     = document.getElementById('settingsOverlay');
  const closeSettingsBtn    = document.getElementById('closeSettingsBtn');
  const colorBlindToggle    = document.getElementById('colorBlindToggle');
  const soundSlider         = document.getElementById('soundSlider');
  const shareButton         = document.getElementById('shareButton');
  // Audio
  const sndLoseLife         = document.getElementById('sndLoseLife');
  const sndHardcoreSelect   = document.getElementById('sndHardcoreSelect');
  const sndHighScore        = document.getElementById('sndHighScore');

  // For demonstration, these base64-encoded <audio> tags are placeholders. 
  // You can replace the src with real .mp3 URLs.

  // Static Menu
  document.getElementById('closeMenu').addEventListener('click', () => {
    document.getElementById('staticMenu').style.display = 'none';
  });

  // Settings
  settingsButton.addEventListener('click', () => {
    settingsOverlay.style.display = 'flex';
  });
  closeSettingsBtn.addEventListener('click', () => {
    settingsOverlay.style.display = 'none';
  });

  // Manage volume
  soundSlider.addEventListener('input', () => {
    let vol = soundSlider.value / 100;
    sndLoseLife.volume = vol;
    sndHardcoreSelect.volume = vol;
    sndHighScore.volume = vol;
  });
  // Initialize volume
  sndLoseLife.volume = 0.5;
  sndHardcoreSelect.volume = 0.5;
  sndHighScore.volume = 0.5;

  // Share button
  shareButton.addEventListener('click', async () => {
    const shareUrl = "https://sites.google.com/view/staticquasar931/static-gmes/static-says";
    const shareText = "Check out this awesome game - Static Says!";

    if (navigator.share) {
      try {
        await navigator.share({
          title: "Static Says",
          text: shareText,
          url: shareUrl
        });
        alert("Thanks for sharing!");
      } catch (err) {
        console.log("Share canceled or failed:", err);
      }
    } else {
      // fallback: copy link to clipboard
      try {
        await navigator.clipboard.writeText(shareUrl);
        alert("Game link copied to clipboard!\n" + shareUrl);
      } catch {
        alert("Unable to share automatically. URL:\n" + shareUrl);
      }
    }
  });

  /********************************************************
    MAP SELECTION
  *********************************************************/
  // Only Map 1 is active
  map1Btn.addEventListener('click', () => {
    // Hide main menu, show difficulty menu
    mainMenu.style.display = 'none';
    difficultyMenu.style.display = 'flex';
  });
  map2Btn.addEventListener('click', () => { /* no-op disabled */ });
  map3Btn.addEventListener('click', () => { /* no-op disabled */ });

  /********************************************************
    DIFFICULTY SELECT
  *********************************************************/
  let currentDifficulty = '';
  let lives = 0;
  let roundScore = 0;
  let currentHighScore = 0;

  // We TRIPLE the time we had before.
  // Previous "easy" ~ 3000ms, "medium" ~ 2200ms, "hardcore" ~ 1500ms
  // Now => easy ~ 9000ms, medium ~ 6600ms, hardcore ~ 4500ms
  let baseTimeLimit = 9000; 

  easyBtn.addEventListener('click', () => {
    currentDifficulty = 'easy';
    lives = 4;
    baseTimeLimit = 9000;
    currentHighScore = gameStats.easy.highScore;
    difficultyInfoText.textContent = "Easy Mode: 4 lives, slower speed. Great for beginners!";
    showRulesOverlay();
  });
  mediumBtn.addEventListener('click', () => {
    currentDifficulty = 'medium';
    lives = 2;
    baseTimeLimit = 6600;
    currentHighScore = gameStats.medium.highScore;
    difficultyInfoText.textContent = "Medium Mode: 2 lives, moderate speed. A good challenge!";
    showRulesOverlay();
  });
  hardcoreBtn.addEventListener('click', () => {
    // Play a small sfx for selecting hardcore
    sndHardcoreSelect.currentTime = 0;
    sndHardcoreSelect.play().catch(e=>{});

    currentDifficulty = 'hardcore';
    lives = 1;
    baseTimeLimit = 4500;
    currentHighScore = gameStats.hardcore.highScore;
    difficultyInfoText.textContent = "Hardcore Mode: 1 life, fastest speed. Good luck!";
    showRulesOverlay();
  });

  function showRulesOverlay() {
    difficultyMenu.style.display = 'none';
    gameArea.style.display = 'block';
    rulesOverlay.style.display = 'flex';
  }

  startGameBtn.addEventListener('click', () => {
    rulesOverlay.style.display = 'none';
    startTheGame();
  });

  /********************************************************
    SHAPE DEFINITIONS (Map 1)
    We'll keep color references just in data for the instructions,
    but visually they're grayscale. Some have numbers, some not.
  *********************************************************/
  const shapeDefinitions = [
    {
      id: "shape1", color: "red",    shapeType: "square",   positionDesc: "top-left corner",   hasNumber: "1"
    },
    {
      id: "shape2", color: "blue",   shapeType: "circle",   positionDesc: "top-right corner",  hasNumber: "2"
    },
    {
      id: "shape3", color: "green",  shapeType: "square",   positionDesc: "bottom-left corner"
    },
    {
      id: "shape4", color: "orange", shapeType: "circle",   positionDesc: "bottom-right corner", hasNumber: "4"
    },
    {
      id: "shape5", color: "yellow", shapeType: "square",   positionDesc: "upper-left area",    hasNumber: "5"
    },
    {
      id: "shape6", color: "purple", shapeType: "circle",   positionDesc: "upper-right area"
    },
    {
      id: "shape7", color: "red",    shapeType: "square",   positionDesc: "middle-left area",   hasNumber: "7"
    },
    {
      id: "shape8", color: "blue",   shapeType: "square",   positionDesc: "center area",        hasNumber: "8"
    },
    {
      id: "shape9", color: "green",  shapeType: "square",   positionDesc: "middle-right area"
    },
    {
      id: "shape10", color: "orange", shapeType: "bigCircle", positionDesc: "lower-left area",  hasNumber: "10"
    },
    {
      id: "shape11", color: "purple", shapeType: "square",    positionDesc: "lower-middle area"
    },
    {
      id: "shape12", color: "yellow", shapeType: "smallCircle",positionDesc: "lower-right area", hasNumber: "12"
    },
    {
      id: "shape13", color: "red",    shapeType: "smallCircle",positionDesc: "somewhere near top center"
    },
    {
      id: "shape14", color: "green",  shapeType: "bigCircle",  positionDesc: "somewhere near top-right area"
    },
    {
      id: "shape15", color: "blue",   shapeType: "circle",     positionDesc: "somewhere middle-top", hasNumber: "15"
    }
  ];

  /********************************************************
    START THE GAME
  *********************************************************/
  let roundActive = false;
  let timerID = null;
  let countdownInterval = null;
  let currentRound = 0;
  let timeLimit = 9000; // will adjust by difficulty

  function startTheGame() {
    // Hide QR code & Stats
    qrContainer.style.display = 'none';
    statsContainer.style.display = 'none';

    roundScore = 0;
    currentRound = 0;
    timeLimit = baseTimeLimit;

    currentDifficultyEl.textContent = currentDifficulty.toUpperCase();
    livesCountEl.textContent = lives;
    roundScoreEl.textContent = roundScore;
    currHighScoreEl.textContent = currentHighScore;

    scoreHUD.style.display = 'block'; 
    inGameHUD.style.display = 'flex';

    nextRound();
  }

  /********************************************************
    NEXT ROUND
  *********************************************************/
  function nextRound() {
    roundActive = true;
    currentRound++;

    // Increase difficulty with rounds (time gets shorter each round)
    // but not too short
    timeLimit = Math.max(baseTimeLimit - (currentRound * 200), 1500);

    // Decide if "Static says" or not (70% chance = "Static says")
    let staticSays = (Math.random() < 0.7);

    // Possibly multi-step commands for higher rounds
    let multiStep = 1;
    if (currentRound >= 5 && Math.random() < 0.4) {
      multiStep = 2; // two steps
    }

    // We'll pick from the entire shape set. 
    // If you want to keep early rounds simpler, you can limit to fewer shapes initially.
    let chosenShapes = [];
    for (let i = 0; i < multiStep; i++) {
      let randomShape = shapeDefinitions[Math.floor(Math.random() * shapeDefinitions.length)];
      chosenShapes.push(randomShape);
    }

    // Build the instruction text
    let instructionText = staticSays ? "Static says: click on " : "Click on ";

    // Color-blind mode check
    let isColorBlind = colorBlindToggle.checked;

    chosenShapes.forEach((shp, idx) => {
      let colorLabel = shp.color;
      if (isColorBlind) {
        // Simple example: "red" => "cbm red"
        colorLabel = "cbm " + shp.color;
      }
      let desc = `${colorLabel} ${shp.shapeType}`;
      if (shp.hasNumber) {
        desc += ` with the number ${shp.hasNumber}`;
      }
      desc += ` in the ${shp.positionDesc}`;
      if (idx > 0) {
        instructionText += (idx === multiStep - 1) ? " then " : ", then ";
      }
      instructionText += desc;
    });

    commandText.innerHTML = instructionText;

    // Setup timer
    let totalTimeSec = Math.ceil(timeLimit / 1000);
    timeLeftEl.textContent = totalTimeSec + "s";

    let timeRemaining = totalTimeSec;
    countdownInterval = setInterval(() => {
      timeRemaining--;
      if (timeRemaining <= 0) {
        clearInterval(countdownInterval);
      }
      timeLeftEl.textContent = Math.max(timeRemaining, 0) + "s";
    }, 1000);

    // If user must do something and fails => lose life
    timerID = setTimeout(() => {
      if (staticSays) {
        // needed to click, but didn't => fail
        finalizeRound(false);
      } else {
        // correct to do nothing => success
        finalizeRound(true);
      }
    }, timeLimit);

    // If "Static says," user must click correct shapes in order
    if (staticSays) {
      let requiredClicks = chosenShapes.map(c => c.id);
      let clickIndex = 0;

      function shapeClickHandler(e) {
        if (!roundActive) return;
        const clickedId = e.target.id;
        if (clickedId === requiredClicks[clickIndex]) {
          clickIndex++;
          if (clickIndex >= requiredClicks.length) {
            finalizeRound(true);
          }
        } else {
          // Wrong shape
          finalizeRound(false);
        }
      }
      shapeDefinitions.forEach(s => {
        let ref = document.getElementById(s.id);
        ref.addEventListener('click', shapeClickHandler);
      });

      function finalizeRound(success) {
        roundActive = false;
        cleanupListeners();
        handleRoundEnd(success);
      }
      function cleanupListeners() {
        clearTimeout(timerID);
        clearInterval(countdownInterval);
        shapeDefinitions.forEach(s => {
          let ref = document.getElementById(s.id);
          ref.removeEventListener('click', shapeClickHandler);
        });
      }
    } else {
      // "Static doesn't say" => correct action is to do nothing
      function shapeClickHandler(e) {
        if (!roundActive) return;
        finalizeRound(false); // user clicked => fail
      }
      shapeDefinitions.forEach(s => {
        let ref = document.getElementById(s.id);
        ref.addEventListener('click', shapeClickHandler);
      });

      function finalizeRound(success) {
        roundActive = false;
        cleanupListeners();
        handleRoundEnd(success);
      }
      function cleanupListeners() {
        clearTimeout(timerID);
        clearInterval(countdownInterval);
        shapeDefinitions.forEach(s => {
          let ref = document.getElementById(s.id);
          ref.removeEventListener('click', shapeClickHandler);
        });
      }
    }
  }

  /********************************************************
    HANDLE ROUND END
  *********************************************************/
  function handleRoundEnd(success) {
    if (success) {
      roundScore++;
      gameStats.totalRounds++;
      gameStats[currentDifficulty].roundsPlayed++;
    } else {
      // Lose life, play sound, screen flick
      lives--;
      flashScreenRed();
      sndLoseLife.currentTime = 0;
      sndLoseLife.play().catch(e=>{});
    }
    updateStatsUI();
    saveStatsToLocal();

    // Update HUD
    roundScoreEl.textContent = roundScore;
    livesCountEl.textContent = lives;

    // Check if game over
    if (lives <= 0) {
      endGame();
    } else {
      nextRound();
    }
  }

  // Screen flick/shake on losing a life
  function flashScreenRed() {
    gameArea.classList.add('lifeLossFlash');
    setTimeout(() => {
      gameArea.classList.remove('lifeLossFlash');
    }, 600);
  }

  /********************************************************
    END GAME
  *********************************************************/
  function endGame() {
    roundActive = false;
    clearTimeout(timerID);
    clearInterval(countdownInterval);

    // If new high score
    if (roundScore > currentHighScore) {
      currentHighScore = roundScore;
      gameStats[currentDifficulty].highScore = roundScore;
      saveStatsToLocal();
      // Play high score sound
      sndHighScore.currentTime = 0;
      sndHighScore.play().catch(e=>{});
    }

    gameOverMsg.textContent = "Your Score: " + roundScore;
    gameOverOverlay.style.display = 'flex';
  }

  menuReturnBtn.addEventListener('click', () => {
    // Return to main menu
    gameOverOverlay.style.display = 'none';
    gameArea.style.display = 'none';
    mainMenu.style.display = 'flex';

    // Show QR & Stats again
    qrContainer.style.display = 'block';
    statsContainer.style.display = 'block';

    updateStatsUI();
  });
  </script>
</body>
</html>
